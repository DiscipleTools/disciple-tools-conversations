{"version":3,"file":"dt-comm-channel.js","sources":["../../../src/components/form/dt-communication-channel/dt-comm-channel.js"],"sourcesContent":["import { html, css } from 'lit';\nimport { classMap } from 'lit/directives/class-map.js';\n\nimport { DtText } from '../dt-text/dt-text.js';\n\nexport class DtCommChannel extends DtText {\n  static get styles() {\n    return [\n      ...super.styles,\n      css`\n        :host {\n          display: block;\n        }\n       .label-wrapper {\n          display: flex;\n          flex-direction: row;\n          flex-wrap: wrap;\n          width: 100%;\n          align-items: center;\n       }\n       .add-btn {\n          background-color: transparent;\n          border: none;\n       }\n        .add-icon {\n          color: var(--dt-comm-channel-add-btn-color, var(--success-color));\n          height: 1.75rem;\n          margin: 0 1rem\n        }\n        .input-group {\n          display: flex;\n          list-style-type: none;\n          margin: 0;\n          padding: 0;\n        }\n        .input-group li {\n          display: flex;\n          width: 100%;\n          flex-direction: row;\n          align-content: center;\n          justify-content: center;\n          align-items: center;\n        }\n        #path0_fill {\n          fill: red;\n        }\n\n        .delete-button {\n          background-color: transparent;\n          border: none;\n        }\n\n        .delete-button svg {\n          width: 100%;\n          height: 20px;\n        }\n      `,\n    ];\n  }\n\n  static get properties() {\n    return {\n      ...super.properties,\n      value: { type: Array, reflect: true }\n    };\n  }\n\n  _addClick() {\n    const newValue = {\n      verified: false,\n      value: '',\n      key: `new-${this.name}-${Math.floor(Math.random() * 100)}`\n    };\n    this.value = [...this.value, newValue];\n    this.requestUpdate();\n  }\n\n  _deleteField(item) {\n    const index = this.value.findIndex(currentItem => currentItem.key === item.key);\n    if (index !== -1) {\n      this.value.splice(index, 1);\n    }\n    this.value = [...this.value];\n    this.requestUpdate();\n  }\n\n  labelTemplate() {\n    if (!this.label) {\n      return '';\n    }\n\n    return html`\n      <dt-label\n        ?private=${this.private}\n        privateLabel=\"${this.privateLabel}\"\n        iconAltText=\"${this.iconAltText}\"\n        icon=\"${this.icon}\"\n      >\n        ${!this.icon\n        ? html`<slot name=\"icon-start\" slot=\"icon-start\"></slot>`\n        : null}\n        ${this.label}\n      </dt-label>\n      <button class=\"add-btn\" @click=${this._addClick}>\n        <svg class=\"add-icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M18 10h-4V6a2 2 0 0 0-4 0l.071 4H6a2 2 0 0 0 0 4l4.071-.071L10 18a2 2 0 0 0 4 0v-4.071L18 14a2 2 0 0 0 0-4z\"></svg>\n      </button>\n    `;\n  }\n\n  _inputFieldTemplate(item) {\n    const isFirstItem = item.key === `new-${this.name}-0`;\n    const deleteButton = !isFirstItem ? html`\n      <button class=\"delete-button\"  @click=${() => this._deleteField(item)}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\">\n          <path\n            id=\"path0_fill\"\n            fill-rule=\"evenodd\"\n            d=\"M 14 7C 14 10.866 10.866 14 7 14C 3.13403 14 0 10.866 0 7C 0 3.13401 3.13403 0 7 0C 10.866 0 14 3.13401 14 7ZM 9.51294 3.51299L 7 6.01299L 4.48706 3.51299L 3.5 4.49999L 6.01294 6.99999L 3.5 9.49999L 4.48706 10.487L 7 7.98699L 9.5 10.5L 10.4871 9.51299L 7.98706 6.99999L 10.5 4.49999L 9.51294 3.51299Z\"\n          />\n        </svg>\n      </button>\n  ` : '';\n    return html`\n      <div class=\"input-group\">\n        <input\n          id=\"${item.key}\"\n          name=\"${this.name}\"\n          aria-label=\"${this.label}\"\n          type=\"${this.type || 'text'}\"\n          placeholder=\"${this.placeholder}\"\n          ?disabled=${this.disabled}\n          ?required=${this.required}\n          class=\"${classMap(this.classes)}\"\n          .value=\"${item.value || ''}\"\n          @change=${this._change}\n          novalidate\n          @keyup=\"${this.implicitFormSubmit}\"\n        />\n        ${deleteButton}\n\n        ${this.touched && this.invalid\n        ? html`<dt-exclamation-circle\n              class=\"icon-overlay alert\"\n            ></dt-exclamation-circle>`\n        : null}\n        ${this.error\n        ? html`<dt-icon\n              icon=\"mdi:alert-circle\"\n              class=\"icon-overlay alert\"\n              tooltip=\"${this.error}\"\n              size=\"2rem\"\n              ></dt-icon>`\n        : null}\n        ${this.loading\n        ? html`<dt-spinner class=\"icon-overlay\"></dt-spinner>`\n        : null}\n        ${this.saved\n        ? html`<dt-checkmark class=\"icon-overlay success\"></dt-checkmark>`\n        : null}\n      </div>\n    `;\n  }\n\n  _setFormValue(value) {\n    super._setFormValue(value);\n    this.internals.setFormValue(JSON.stringify(value));\n    this.value = [...this.value];\n  }\n\n  _change(e) {\n    const key = e.target.id;\n    const { value } = e.target;\n    const newValue = this.value;\n    this.value.find((o, i) => {\n      if (o.key === key) {\n        newValue[i] = { verified: false, value, key };\n        return true; // stop searching\n      }\n      return false;\n    });\n\n    const event = new CustomEvent('change', {\n      detail: {\n        field: this.name,\n        oldValue: this.value,\n        newValue,\n      },\n    });\n\n    this.value = newValue;\n\n    this._setFormValue(this.value);\n\n    this.dispatchEvent(event);\n  }\n\n  _renderInputFields() {\n    if (!this.value) {\n      this.value = [{\n        verified: false,\n        value: '',\n        key: `new-${this.name}-0`\n      }];\n\n      // initializing with 0 so that delete button does comes in\n      return this._inputFieldTemplate(this.value[0]);\n    }\n    return html`\n      ${this.value.map((item) =>\n      this._inputFieldTemplate(item)\n    )}\n    `;\n  }\n\n  render() {\n    return html`\n     <div class=\"label-wrapper\">\n        ${this.labelTemplate()}\n      </div>\n      ${this._renderInputFields()}\n    `;\n  }\n}\n\nwindow.customElements.define('dt-comm-channel', DtCommChannel);\n"],"names":["window","customElements","define","DtText","styles","super","css","properties","value","type","Array","reflect","_addClick","newValue","verified","key","this","name","Math","floor","random","requestUpdate","_deleteField","item","index","findIndex","currentItem","splice","labelTemplate","label","html","private","privateLabel","iconAltText","icon","_inputFieldTemplate","deleteButton","placeholder","disabled","required","classMap","classes","_change","implicitFormSubmit","touched","invalid","error","loading","saved","_setFormValue","internals","setFormValue","JSON","stringify","e","target","id","find","o","i","event","CustomEvent","detail","field","oldValue","dispatchEvent","_renderInputFields","map","render"],"mappings":"qaAgOAA,OAAOC,eAAeC,OAAO,kBA3NtB,cAA4BC,EACtBC,oBACT,MAAO,IACFC,MAAMD,OACTE,CAAG,+jBAiDN,CAEUC,wBACT,MAAO,IACFF,MAAME,WACTC,MAAO,CAAEC,KAAMC,MAAOC,SAAS,GAElC,CAEDC,YACE,MAAMC,EAAW,CACfC,UAAU,EACVN,MAAO,GACPO,IAAK,OAAOC,KAAKC,QAAQC,KAAKC,MAAsB,IAAhBD,KAAKE,aAE3CJ,KAAKR,MAAQ,IAAIQ,KAAKR,MAAOK,GAC7BG,KAAKK,eACN,CAEDC,aAAaC,GACX,MAAMC,EAAQR,KAAKR,MAAMiB,WAAUC,GAAeA,EAAYX,MAAQQ,EAAKR,OAC5D,IAAXS,GACFR,KAAKR,MAAMmB,OAAOH,EAAO,GAE3BR,KAAKR,MAAQ,IAAIQ,KAAKR,OACtBQ,KAAKK,eACN,CAEDO,gBACE,OAAKZ,KAAKa,MAIHC,CAAI,uBAEId,KAAKe,0BACAf,KAAKgB,8BACNhB,KAAKiB,sBACZjB,KAAKkB,SAEVlB,KAAKkB,KAEN,KADAJ,CAAI,uDAEJd,KAAKa,mDAEwBb,KAAKJ,2PAf/B,EAmBV,CAEDuB,oBAAoBZ,GAClB,MACMa,EADcb,EAAKR,MAAQ,OAAOC,KAAKC,SAW3C,GAVkCa,CAAI,yCACE,IAAMd,KAAKM,aAAaC,mbAUlE,OAAOO,CAAI,uCAGCP,EAAKR,cACHC,KAAKC,qBACCD,KAAKa,gBACXb,KAAKP,MAAQ,wBACNO,KAAKqB,2BACRrB,KAAKsB,wBACLtB,KAAKuB,oBACRC,EAASxB,KAAKyB,qBACblB,EAAKf,OAAS,gBACdQ,KAAK0B,+BAEL1B,KAAK2B,wBAEfP,KAEApB,KAAK4B,SAAW5B,KAAK6B,QACrBf,CAAI,6EAGJ,QACAd,KAAK8B,MACLhB,CAAI,wEAGWd,KAAK8B,gCAGpB,QACA9B,KAAK+B,QACLjB,CAAI,iDACJ,QACAd,KAAKgC,MACLlB,CAAI,6DACJ,YAGP,CAEDmB,cAAczC,GACZH,MAAM4C,cAAczC,GACpBQ,KAAKkC,UAAUC,aAAaC,KAAKC,UAAU7C,IAC3CQ,KAAKR,MAAQ,IAAIQ,KAAKR,MACvB,CAEDkC,QAAQY,GACN,MAAMvC,EAAMuC,EAAEC,OAAOC,IACfhD,MAAEA,GAAU8C,EAAEC,OACd1C,EAAWG,KAAKR,MACtBQ,KAAKR,MAAMiD,MAAK,CAACC,EAAGC,IACdD,EAAE3C,MAAQA,IACZF,EAAS8C,GAAK,CAAE7C,UAAU,EAAON,QAAOO,QACjC,KAKX,MAAM6C,EAAQ,IAAIC,YAAY,SAAU,CACtCC,OAAQ,CACNC,MAAO/C,KAAKC,KACZ+C,SAAUhD,KAAKR,MACfK,cAIJG,KAAKR,MAAQK,EAEbG,KAAKiC,cAAcjC,KAAKR,OAExBQ,KAAKiD,cAAcL,EACpB,CAEDM,qBACE,OAAKlD,KAAKR,MAUHsB,CAAI,GACPd,KAAKR,MAAM2D,KAAK5C,GAClBP,KAAKmB,oBAAoBZ,QAXzBP,KAAKR,MAAQ,CAAC,CACZM,UAAU,EACVN,MAAO,GACPO,IAAK,OAAOC,KAAKC,WAIZD,KAAKmB,oBAAoBnB,KAAKR,MAAM,IAO9C,CAED4D,SACE,OAAOtC,CAAI,8BAELd,KAAKY,wBAEPZ,KAAKkD,sBAEV"}